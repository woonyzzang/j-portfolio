<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="브이더블유 제안 시안 디자인 갤러리">
<meta name="author" content="Joe Seung Woon">
<!-- <link rel="shortcut icon" href="favicon.ico"> -->
<title>VW Draft Design</title>
<link rel="stylesheet" href="unitegallery/css/unite-gallery.css">
<style>
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0}
:root,body{height:100%}
a.ug-lightbox-button-close{overflow:hidden;-webkit-transition:-webkit-transform .35s!important;transition:transform .35s!important;position:absolute;width:36px;height:36px;margin:4px 0 0 -6px;background:url('unitegallery/images/lightbox-icon-close.png') no-repeat;text-indent:-9999px}
a.ug-lightbox-button-close:hover,
a.ug-lightbox-button-close:focus{-ms-transform:rotate(180deg);-webkit-transform:rotate(180deg);transform:rotate(180deg)}
</style>
</head>
<body>
<div id="gallery" style="display:none"></div>

<!-- [D] 갤러리 템플릿 -->
<script id="gallery-templ" type="text/x-handlebars-template">
{{#each gallery}}
<img src="{{img}}" data-image="{{simg}}" data-description="step - {{desc}}" alt="{{title}} 시안">
{{/each}}
</script>
<!-- //[D] 갤러리 템플릿 -->

<script src="lib/jquery-1.12.4.min.js"></script>
<script src="lib/handlebars-v4.0.5.js"></script>
<script src="unitegallery/js/unitegallery.min.js"></script>
<script src="unitegallery/themes/compact/ug-theme-compact.js"></script>
<script>
(function($) {

	location.queryString = {};
	location.search.substr(1).split('&').forEach(function(pair) {
		if (pair === '') { return; }

		var parts = pair.split('=');

		location.queryString[parts[0]] = parts[1] && decodeURIComponent(parts[1].replace(/\+/g, ' '));
	});

	var locSrch = location.queryString;
	var designType = locSrch.designType;
	var imgPath = 'img/' + designType + '/gallery/' + locSrch.query + '/';

	var jqxhr = $.ajax({
		dataType : 'json',
		url : 'data/' + designType + '/gallery/' + locSrch.query + '/gallery.json'
	});

	/**
	 * @갤러리뷰 그리기
	 */
	function unitegallery() {
		var $btnClse = $('<a href="index.html?draftType=design" title="close" class="ug-lightbox-button-close">close</a>');

		$('#gallery').unitegallery({
			gallery_width : '100%',
			gallery_height : '100%',
			gallery_min_width : '100%',
			gallery_min_height : '100%',
			theme_panel_position : 'right',
			slider_scale_mode : 'fit',
			slider_control_swipe : false
		});

		$('.ug-zoompanel').append($btnClse);
	}

	/**
	 * @갤러리 이미지 동적 생성
	 */
	function galleryItemRander(data) {
		var $gallery = $('#gallery');
		//var galleryItem = '';
		var source = $('#gallery-templ').html();
		var dataObj = {
			gallery : []
		};

		/*for (var i = 0, len = data.images.length; i < len; i++) {
			galleryItem += '<img src="' + (imgPath + data.images[i]) + '" data-image="' + (imgPath + data.images[i]) + '" data-description="step - ' + (i + 1) + '" alt="' + data.title + ' 시안">';
		}*/

		for (var i = 0, len = data.images.length; i < len; i++) {
			dataObj.gallery.push({
				img : imgPath + data.images[i],
				simg : imgPath + data.images[i],
				desc : i + 1,
				title : data.title
			});
		}

		var template = Handlebars.compile(source);
		var html = template(dataObj);
		$gallery.append(html);
		//$gallery.append($(galleryItem));
		unitegallery();
	}

	/**
	 * @초기화
	 */
	(function init() {
		jqxhr
			.done(function(data) {
				galleryItemRander(data);
			})
			.fail(function() {
				console.error('fail');
			})
			.always(function(data) {
				//console.log(data);
			});
	})();

})(jQuery);
</script>
</body>
</html>